# Project Plan: Financial AI Manager

This document is the single source of truth for the development plan, tracking all features from conception to completion.

---

### Foundational & Core Features

---

## Feature: Full-Stack Migration (PERN + GraphQL)

-   **Status:** Completed
-   **Description:** Migrate the application from a client-side only demo to a full-stack architecture using PostgreSQL, Express, React, and Node (PERN stack) with a GraphQL API. This establishes a robust and scalable foundation for all future development.
-   **Key Requirements & Acceptance Criteria:**
    -   [x] Establish a Yarn Workspaces monorepo for client/server packages.
    -   [x] Set up a local PostgreSQL database using Docker.
    -   [x] Create a database schema and seeding script.
    -   [x] Implement a Node/Express backend server with Apollo Server.
    -   [x] Build a complete GraphQL API for all CRUD operations.
    -   [x] Move the Gemini API integration to the backend server.
    -   [x] Integrate Apollo Client into the React frontend and refactor all data fetching.
-   **Dependencies:** None.
-   **Potential Enhancements:**
    -   Implement GraphQL Subscriptions for real-time data updates.
    -   Introduce caching strategies (e.g., Redis) to reduce database load.

---

## Feature: Application Core & Navigation

-   **Status:** Completed
-   **Description:** As a user, I need a consistent and intuitive navigation structure to move between the different sections of the application, such as the Dashboard, Transactions, and Settings.
-   **Key Requirements & Acceptance Criteria:**
    -   [x] A persistent sidebar is present on the left side of the screen.
    -   [x] The sidebar contains clear, icon-based navigation buttons for all main pages.
    -   [x] The currently active page is visually highlighted in the sidebar.
    -   [x] Navigation buttons are disabled until data is loaded to prevent navigating to empty states.
    -   [x] A "Reset" button is available to clear all data and return to the initial state.
-   **Dependencies:** Feature: Full-Stack Migration (PERN + GraphQL).
-   **Potential Enhancements:**
    -   Add keyboard shortcuts for quick navigation between pages.
    -   Implement a responsive mobile-friendly navigation (e.g., a collapsible hamburger menu).

---

## Feature: Data Input & Onboarding

-   **Status:** Completed
-   **Description:** As a new user, I can easily get started by either connecting to the pre-populated database or by uploading my own transaction file.
-   **Key Requirements & Acceptance Criteria:**
    -   [x] The initial screen presents two clear options: "Connect to Database" and "Import File".
    -   [x] Clicking "Connect to Database" fetches all data and navigates to the Dashboard.
    -   [x] The "Import File" option provides a drag-and-drop zone or file selector for `.csv` and `.xlsx` files.
    -   [x] A loading indicator is displayed while data is being fetched or a file is being processed.
    -   [x] Clear error messages are shown if the connection fails or the file is invalid.
-   **Dependencies:** Feature: Full-Stack Migration (PERN + GraphQL).

---

### User-Facing Features

---

## Feature: Financial Dashboard

-   **Status:** Completed
-   **Description:** As a user, I can view a comprehensive, high-level dashboard that summarizes my financial health and visualizes key trends.
-   **Key Requirements & Acceptance Criteria:**
    -   [x] Dashboard displays key metrics in summary cards: Total Income, Total Expenses, and Net Savings.
    -   [x] An "AI Financial Analyst" section displays the summary generated by the Gemini API.
    -   [x] A bar chart visualizes monthly income vs. expenses over time.
    -   [x] A pie chart shows the breakdown of expenses by category.
    -   [x] Users can filter the entire dashboard view by a specific account using a dropdown menu.
    -   [x] A paginated table shows a preview of all transactions for the selected account.
-   **Dependencies:** Feature: Full-Stack Migration (PERN + GraphQL).
-   **Potential Enhancements:**
    -   Add a global date-range filter to the dashboard to analyze specific periods.
    -   Allow users to customize the dashboard layout (e.g., hide or reorder widgets).
    -   Introduce budgeting goals with progress bars.

---

## Feature: AI-Powered Financial Summary

-   **Status:** Completed
-   **Description:** As a user, I can receive an automated, intelligent analysis of my financial data, providing a narrative summary and actionable advice without manual effort.
-   **Key Requirements & Acceptance Criteria:**
    -   [x] The backend securely calls the Gemini API with the user's transaction data.
    -   [x] The prompt sent to the AI is well-structured and asks for a specific JSON output.
    -   [x] The Gemini API response is parsed and displayed in a dedicated "AI Financial Analyst" section on the dashboard.
    -   [x] The analysis includes an overall summary, income analysis, expense analysis, and a list of actionable insights.
    -   [x] A clear loading state is displayed while the AI analysis is in progress.
-   **Dependencies:** Feature: Full-Stack Migration (PERN + GraphQL).
-   **Potential Enhancements:**
    -   Allow users to ask follow-up questions about their summary in a chat-like interface.
    -   Generate comparative analyses (e.g., "How does this month compare to last month?").

---

## Feature: Transaction Management

-   **Status:** Completed
-   **Description:** As a user, I can view, search, and manage all of my financial transactions in a detailed and organized manner.
-   **Key Requirements & Acceptance Criteria:**
    -   [x] A dedicated "Transactions" page displays all transactions in a sortable, paginated table.
    -   [x] Users can add a new transaction via a modal form.
    -   [x] Users can edit an existing transaction via the same modal form.
    -   [x] Users can delete a transaction with a confirmation prompt.
    -   [x] Powerful filtering options are available: search by description, filter by type (income/expense), filter by category, and select a date range.
    -   [x] A summary section shows the total income and expenses for the currently filtered results.
-   **Dependencies:** Feature: Full-Stack Migration (PERN + GraphQL).
-   **Potential Enhancements:**
    -   Implement bulk editing (e.g., select multiple transactions and re-categorize all at once).
    -   Add the ability to split a single transaction into multiple categories.

---

## Feature: File Import & Staging

-   **Status:** Completed
-   **Description:** As a user, I can upload a transaction file and review, edit, and selectively import the data, ensuring data accuracy before it's saved.
-   **Key Requirements & Acceptance Criteria:**
    -   [x] The application can parse `.csv` and `.xlsx` files with flexible column headers.
    -   [x] Parsed transactions are displayed on a dedicated "Import" page.
    -   [x] Users can select or deselect transactions to be imported using checkboxes.
    -   [x] Users can add, edit, or delete transactions in the staging area before the final import.
    -   [x] Clicking "Save Selected to Database" saves only the checked transactions and navigates to the dashboard.
-   **Dependencies:** Feature: Full-Stack Migration (PERN + GraphQL).

---

## Feature: Settings Management

-   **Status:** Completed
-   **Description:** As a user, I can customize the application by managing my own lists of financial accounts and spending categories.
-   **Key Requirements & Acceptance Criteria:**
    -   [x] A dedicated "Settings" page is available.
    -   [x] Users can add a new category or account.
    -   [x] Users can rename an existing category or account.
    -   [x] Users can delete a category or account with a confirmation prompt.
    -   [x] Changes are reflected across the application (e.g., in transaction dropdowns).
-   **Dependencies:** Feature: Full-Stack Migration (PERN + GraphQL).
-   **Potential Enhancements:**
    -   Add the ability to assign a color to each category for better visualization in charts.
    -   Allow users to set monthly budgets for each category.

---

## Feature: Credit Card Management

-   **Status:** Not Started
-   **Description:** As a user, I want to manage my credit cards by tracking their specific closing and due dates. I need to see the current statement balance, a list of future/unpaid transactions, and ensure that credit card payments are properly integrated into my overall financial picture.
-   **Key Requirements & Acceptance Criteria:**
    -   **Data Model:**
        -   Credit Cards will be a special type of "Account", distinguished by an `account_type` field.
        -   Credit Card accounts will have additional properties: `closing_day` (day of the month) and `payment_due_day` (day of the month).
        -   Credit Card payments must be recorded as "Transfer" transactions from a liquid account (e.g., Checking) to the Credit Card account.
    -   **Settings UI:**
        -   In the Settings > Accounts section, users can create or edit an account and specify its type as "Credit Card".
        -   When "Credit Card" type is selected, input fields for "Closing Day" and "Payment Due Day" must become visible and required.
    -   **Transaction Entry:**
        -   When adding an expense transaction, the user must be able to select a Credit Card as the payment source from the "Account" dropdown.
        -   The transaction form must include an option for installment purchases.
        -   The user must be able to input the number of installments for a purchase. The system will automatically calculate and generate all future installment transactions, dated one month apart and linked together.
    -   **Credit Card Detail View:**
        -   A new dedicated view will be accessible for each credit card to see its specific dashboard.
        -   This view must display a list of transactions for the current open statement (i.e., transactions between the last closing day and the next closing day).
        -   It must show the total balance for the current statement, including a category breakdown chart.
        -   It must display a historical chart of the last 12 closed statement totals.
        -   It must provide a list of upcoming future statements, showing the installment transactions scheduled for each period.
-   **Dependencies:**
    -   Feature: Full-Stack Migration (PERN + GraphQL)
    -   Feature: Transaction Management
-   **Potential Enhancements:**
    -   Automatic reminders for upcoming payment due dates.
    -   Charts showing credit card debt over time.

---

### Quality, Operations & Future AI

---

## Feature: Code Quality Framework: Linting & Testing

-   **Status:** Completed
-   **Description:** As a developer, I want a robust code quality and testing framework to ensure code consistency, prevent errors, and improve long-term maintainability.
-   **Key Requirements & Acceptance Criteria:**
    -   [x] ESLint is integrated for static code analysis.
    -   [x] Prettier is integrated for automated code formatting.
    -   [x] Jest and React Testing Library are integrated for unit and component testing.
    -   [x] Root-level scripts (`lint`, `format`, `test`) are available.
    -   [x] Example tests for both frontend and backend are implemented.
-   **Dependencies:** Feature: Full-Stack Migration (PERN + GraphQL).

---

## Feature: Comprehensive Component Test Coverage

-   **Status:** In Progress
-   **Description:** As a developer, I want all React components and key backend services to have comprehensive tests to ensure the application is reliable and free of regressions.
-   **Key Requirements & Acceptance Criteria:**
    -   [ ] Test all presentational components for correct prop rendering.
    -   [ ] Test all interactive components, including user events and callback triggers.
    -   [ ] Test page-level components with mocked Apollo Client data to verify integration.
    -   [ ] Test high-level application flows, such as navigation and modal interactions.
    -   [ ] Achieve a target of >80% test coverage for all critical services and components.
-   **Dependencies:** Feature: Code Quality Framework: Linting & Testing.

---

## Feature: AI-Powered Transaction Categorization

-   **Status:** Not Started
-   **Description:** As a user importing a transaction file, I want the application to automatically suggest a category for each transaction based on its description, significantly reducing the manual effort required for data entry.
-   **Key Requirements & Acceptance Criteria:**
    -   [ ] A "Suggest Categories" button is added to the Import page.
    -   [ ] Clicking the button sends uncategorized transaction descriptions to the Gemini API.
    -   [ ] The AI returns a suggested category for each transaction from the user's existing list.
    -   [ ] Category dropdowns in the import table are automatically populated with the AI's suggestions.
    -   [ ] The user can review and override any AI suggestion before saving.
    -   [ ] A clear loading state is shown while the AI is processing the request.
-   **Dependencies:** Feature: File Import & Staging.

---

## Feature: Production Readiness: Documentation & GCP Deployment

-   **Status:** Completed
-   **Description:** As a developer, I need comprehensive documentation and a clear deployment path to get the application running in a production environment on Google Cloud Platform.
-   **Key Requirements & Acceptance Criteria:**
    -   [x] A multi-stage `Dockerfile` for containerizing the backend service is created.
    -   [x] Technical documentation covering the project architecture and local setup is written.
    -   [x] A step-by-step deployment guide for GCP (Cloud SQL, Cloud Run, Cloud Storage) is available.
    -   [x] The deployment guide includes a detailed cost estimation and free tier analysis.
-   **Dependencies:** Feature: Full-Stack Migration (PERN + GraphQL).
